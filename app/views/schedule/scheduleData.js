const data = {
	metadata: {},
	data: [
		{
			term_code: 'FA15',
			subject_code: 'CHIN',
			course_code: '100AN',
			units: 4,
			course_level: 'UD',
			grade_option: 'L',
			course_title: 'Third Yr Chinese/Non-Native I',
			enrollment_status: 'DR',
			repeat_code: 'N',
			section_data: [
				{
					section: '843632',
					meeting_type: 'Lecture',
					time: '12:30 - 13:50',
					days: 'TU',
					building: 'SEQUO',
					room: '147',
					instructor_name: 'Wang, Xiao',
					special_mtg_code: ''
				},
				{
					section: '843632',
					meeting_type: 'Lecture',
					time: '12:30 - 13:50',
					days: 'TH',
					building: 'SEQUO',
					room: '147',
					instructor_name: 'Wang, Xiao',
					special_mtg_code: ''
				},
				{
					section: '843632',
					meeting_type: 'Lecture',
					time: '11:30 - 14:29',
					days: 'FR',
					building: 'SEQUO',
					room: '147',
					instructor_name: 'Wang, Xiao',
					special_mtg_code: 'FI'
				}
			]
		},
		{
			term_code: 'FA15',
			subject_code: 'CSE',
			course_code: '120',
			units: 4,
			course_level: 'UD',
			grade_option: 'L',
			course_title: 'Princ/Computer Operating Systm',
			enrollment_status: 'EN',
			repeat_code: 'D',
			section_data: [
				{
					section: '849827',
					meeting_type: 'Lecture',
					time: '19:00 - 20:50',
					days: 'MO',
					building: 'PCYNH',
					room: '109',
					instructor_name: 'Voelker, Geoffrey M.',
					special_mtg_code: 'RE'
				},
				{
					section: '849827',
					meeting_type: 'Lecture',
					time: '18:00 - 19:50',
					days: 'MO',
					building: 'CENTR',
					room: '214',
					instructor_name: 'Voelker, Geoffrey M.',
					special_mtg_code: 'RE'
				},
				{
					section: '849827',
					meeting_type: 'Lecture',
					time: '8:00 - 9:20',
					days: 'TU',
					building: 'CENTR',
					room: '115',
					instructor_name: 'Voelker, Geoffrey M.',
					special_mtg_code: ''
				},
				{
					section: '849827',
					meeting_type: 'Lecture',
					time: '8:00 - 10:59',
					days: 'TU',
					building: 'CENTR',
					room: '115',
					instructor_name: 'Voelker, Geoffrey M.',
					special_mtg_code: 'FI'
				},
				{
					section: '849827',
					meeting_type: 'Lecture',
					time: '8:00 - 9:20',
					days: 'TH',
					building: 'CENTR',
					room: '115',
					instructor_name: 'Voelker, Geoffrey M.',
					special_mtg_code: ''
				},
				{
					section: '849827',
					meeting_type: 'Lecture',
					time: '10:00 - 11:50',
					days: 'SA',
					building: 'CENTR',
					room: '214',
					instructor_name: 'Voelker, Geoffrey M.',
					special_mtg_code: 'RE'
				},
				{
					section: '849827',
					meeting_type: 'Lecture',
					time: '11:00 - 12:20',
					days: 'SU',
					building: 'CENTR',
					room: '105',
					instructor_name: 'Voelker, Geoffrey M.',
					special_mtg_code: 'RE'
				}
			]
		},
		{
			term_code: 'FA15',
			subject_code: 'CSE',
			course_code: '131',
			units: 4,
			course_level: 'UD',
			grade_option: 'L',
			course_title: 'Compiler Construction',
			enrollment_status: 'EN',
			repeat_code: 'D',
			section_data: [
				{
					section: '849838',
					meeting_type: 'Lecture',
					time: '18:30 - 19:50',
					days: 'MO',
					building: 'GH',
					room: '242',
					instructor_name: 'Bournoutian, Garo',
					special_mtg_code: ''
				},
				{
					section: '849838',
					meeting_type: 'Lecture',
					time: '19:00 - 21:59',
					days: 'MO',
					building: 'GH',
					room: '242',
					instructor_name: 'Bournoutian, Garo',
					special_mtg_code: 'FI'
				},
				{
					section: '849838',
					meeting_type: 'Lecture',
					time: '18:30 - 19:50',
					days: 'WE',
					building: 'GH',
					room: '242',
					instructor_name: 'Bournoutian, Garo',
					special_mtg_code: ''
				},
				{
					section: '849838',
					meeting_type: 'Lecture',
					time: '15:00 - 16:50',
					days: 'SU',
					building: 'CENTR',
					room: '105',
					instructor_name: 'Bournoutian, Garo',
					special_mtg_code: 'RE'
				},
				{
					section: '849838',
					meeting_type: 'Lecture',
					time: '15:00 - 16:50',
					days: 'SU',
					building: 'CENTR',
					room: '105',
					instructor_name: 'Bournoutian, Garo',
					special_mtg_code: 'RE'
				},
				{
					section: '849838',
					meeting_type: 'Lecture',
					time: '15:00 - 16:50',
					days: 'SU',
					building: 'CENTR',
					room: '105',
					instructor_name: 'Bournoutian, Garo',
					special_mtg_code: 'RE'
				},
				{
					section: '849838',
					meeting_type: 'Lecture',
					time: '15:00 - 16:50',
					days: 'SU',
					building: 'CENTR',
					room: '105',
					instructor_name: 'Bournoutian, Garo',
					special_mtg_code: 'RE'
				},
				{
					section: '849838',
					meeting_type: 'Lecture',
					time: '15:00 - 16:50',
					days: 'SU',
					building: 'CENTR',
					room: '105',
					instructor_name: 'Bournoutian, Garo',
					special_mtg_code: 'RE'
				},
				{
					section: '849838',
					meeting_type: 'Lecture',
					time: '14:00 - 15:50',
					days: 'SU',
					building: 'CENTR',
					room: '115',
					instructor_name: 'Bournoutian, Garo',
					special_mtg_code: 'RE'
				}
			]
		},
		{
			term_code: 'FA15',
			subject_code: 'CSE',
			course_code: '141',
			units: 4,
			course_level: 'UD',
			grade_option: 'L',
			course_title: 'Intro/Computer Architecture',
			enrollment_status: 'EN',
			repeat_code: 'D',
			section_data: [
				{
					section: '849851',
					meeting_type: 'Discussion',
					time: '8:00 - 8:50',
					days: 'FR',
					building: 'WLH',
					room: '2001',
					instructor_name: 'Porter, Leonard Emerson',
					special_mtg_code: ''
				}
			]
		},
		{
			term_code: 'FA15',
			subject_code: 'CSE',
			course_code: '141L',
			units: 2,
			course_level: 'UD',
			grade_option: 'PNP',
			course_title: 'Project/Computer Architecture',
			enrollment_status: 'EN',
			repeat_code: 'D',
			section_data: [
				{
					section: '849854',
					meeting_type: 'Lecture',
					time: '15:00 - 15:50',
					days: 'MO',
					building: 'CENTR',
					room: '216',
					instructor_name: 'Eldon, Johnny',
					special_mtg_code: ''
				},
				{
					section: '849854',
					meeting_type: 'Lecture',
					time: '15:00 - 17:59',
					days: 'FR',
					building: 'CENTR',
					room: '216',
					instructor_name: 'Eldon, Johnny',
					special_mtg_code: 'FI'
				}
			]
		}
	]
};

// Returns a modified courseItems object containing only finals.
export function getFinals() {
	const finalItems = {
		MO: [],
		TU: [],
		WE: [],
		TH: [],
		FR: [],
		SA: [],
		SU: []
	};

	const courseItems = getData();
	Object.keys(courseItems).forEach((day) => {
		courseItems[day].forEach((item) => {
			if (item.special_mtg_code == 'FI') {
				finalItems[day].push(item);
			}
		});
	});

	return finalItems;
}

// Returns a modified courseItems object containing only classes (includes discussions).
export function getClasses() {
	const classItems = {
		MO: [],
		TU: [],
		WE: [],
		TH: [],
		FR: [],
		SA: [],
		SU: []
	};

	const courseItems = getData();
	Object.keys(courseItems).forEach((day) => {
		courseItems[day].forEach((item) => {
			if (item.special_mtg_code == '') {
				classItems[day].push(item);
			}
		});
	});

	return classItems;
}

export function dayOfWeekInterpreter(abbr) {
	let fullString = '';
	switch (abbr) {
	case 'MO':
		fullString = 'Monday';
		break;
	case 'TU':
		fullString = 'Tuesday';
		break;
	case 'WE':
		fullString = 'Wednesday';
		break;
	case 'TH':
		fullString = 'Thursday';
		break;
	case 'FR':
		fullString = 'Friday';
		break;
	case 'SA':
		fullString = 'Saturday';
		break;
	case 'SU':
		fullString = 'Sunday';
		break;
	default:
		fullString = abbr;
	}
	return fullString;
}

// Returns a courseItems object containing lists of courseItem objects.
// There is one list per day of the week and the courseItem objects are
// sorted by their start times. This includes "FI" and "RE" meeting types.
export function getData() {
	const courses = data.data;
	const enrolledCourses = [];
	const courseItems = {
		MO: [],
		TU: [],
		WE: [],
		TH: [],
		FR: [],
		SA: [],
		SU: []
	};

	// loop thru "data"
	// grab all enrolled classes bc academic history has dropped/waitlisted classes too...
	for (let i = 0; i < courses.length; ++i) {
		if (courses[i].enrollment_status === 'EN') {
			enrolledCourses.push(courses[i]);
		}
	}

	// grab all "section_data" where "special_mtg_code" === ""
	// put into days
	for (let j = 0; j < enrolledCourses.length; ++j) {
		const currCourse = enrolledCourses[j];
		const currSectionData = currCourse.section_data;
		for (let k = 0; k < currSectionData.length; ++k) {
			const currData = currSectionData[k];
			// if (currData.special_mtg_code === '') {
			// time format is HH:MM - HH:MM
			// split time string and get seconds
			const timeString = currData.time;
			const timeArr = timeString.split(' ');
			const startString = timeArr[0];
			const endString = timeArr[2];
			const startArr = startString.split(':'); // split it at the colons
			const endArr = endString.split(':'); // split it at the colons
			// minutes are worth 60 seconds. Hours are worth 60 minutes.
			const startSeconds = +startArr[0] * 60 * 60 + +startArr[1] * 60;
			const endSeconds = +endArr[0] * 60 * 60 + +endArr[1] * 60;

			const day = currData.days;

			const item = {
				building: currData.building,
				room: currData.room,
				instructor_name: currData.instructor_name,
				section: currData.section,
				subject_code: currCourse.subject_code,
				course_code: currCourse.course_code,
				course_title: currCourse.course_title,
				time_string: timeString,
				start_time: startSeconds,
				end_time: endSeconds,
				meeting_type: currData.meeting_type,
				special_mtg_code: currData.special_mtg_code,
				day_code: currData.days,
				grade_option: currCourse.grade_option,
				course_level: currCourse.course_level,
				units: currCourse.units,
			};

			courseItems[day].push(item);
			// }
		}
	}

	// sort by "time"
	const courseItemsKeys = Object.keys(courseItems);
	for (let l = 0; l < courseItemsKeys.length; ++l) {
		const courseItem = courseItems[courseItemsKeys[l]];
		courseItem.sort(sortTime);
	}

	return courseItems;
}

function sortTime(a, b) {
	return a.start_time - b.start_time;
}
